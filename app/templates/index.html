<!-- app/templates/index.html -->
{% extends "base.html" %}

{% block title %}{{ t.page_title }}{% endblock %}

{% block body %}
<header class="hero">
  <h1>{{ t.hero_title }}</h1>
</header>

<section class="card">
  <label class="dropzone" id="dropBox">
      <input
      id="fileInput"
      type="file"
      accept="application/pdf,image/jpeg,image/png,.pdf,.jpg,.jpeg,.png"
      multiple
    />
    <div class="dropzone-inner">
      <div class="drop-icon">⬆️</div>
      <strong>{{ t.drop_instruction }}</strong>
      <p class="upload-limit">{{ t.upload_limit_note.format(limit=limits.total_upload_mb) }}</p>
    </div>
  </label>
  <div id="files" class="file-list empty">
    <p class="empty-state">{{ t.empty_state }}</p>
  </div>

  <section class="global-controls" aria-label="{{ t.global_controls_title }}">
    <div class="global-controls-header">
      <span class="global-controls-title">{{ t.global_controls_title }}</span>
      <span class="global-controls-description">{{ t.global_controls_description }}</span>
    </div>

    <div class="global-controls-grid">
      <label>
        <span>{{ t.paper_size_label }}</span>
        <select id="globalPaper" class="option-select">
          <option value="auto" {% if defaults.paper_size == 'auto' %}selected{% endif %}>{{ t.paper_size_auto }}</option>
          <option value="A4" {% if defaults.paper_size == 'A4' %}selected{% endif %}>{{ t.paper_size_a4 }}</option>
          <option value="Letter" {% if defaults.paper_size == 'Letter' %}selected{% endif %}>{{ t.paper_size_letter }}</option>
        </select>
      </label>
      <label>
        <span>{{ t.orientation_label }}</span>
        <select id="globalOrientation" class="option-select">
          <option value="auto" {% if defaults.orientation == 'auto' %}selected{% endif %}>{{ t.orientation_auto }}</option>
          <option value="portrait" {% if defaults.orientation == 'portrait' %}selected{% endif %}>{{ t.orientation_portrait }}</option>
          <option value="landscape" {% if defaults.orientation == 'landscape' %}selected{% endif %}>{{ t.orientation_landscape }}</option>
          <option value="rotate90" {% if defaults.orientation == 'rotate90' %}selected{% endif %}>{{ t.orientation_rotate90 }}</option>
          <option value="rotate180" {% if defaults.orientation == 'rotate180' %}selected{% endif %}>{{ t.orientation_rotate180 }}</option>
          <option value="rotate270" {% if defaults.orientation == 'rotate270' %}selected{% endif %}>{{ t.orientation_rotate270 }}</option>
        </select>
      </label>
      <label>
        <span>{{ t.scale_mode_label }}</span>
        <select id="globalFit" class="option-select">
          <option value="auto" {% if defaults.fit_mode == 'auto' %}selected{% endif %}>{{ t.scale_mode_auto }}</option>
          <option value="letterbox" {% if defaults.fit_mode == 'letterbox' %}selected{% endif %}>{{ t.scale_mode_letterbox }}</option>
          <option value="crop" {% if defaults.fit_mode == 'crop' %}selected{% endif %}>{{ t.scale_mode_crop }}</option>
        </select>
      </label>
    </div>
  </section>

  <div class="form-grid">
    <label>
      {{ t.output_label }}
      <input id="outputName" type="text" value="{{ defaults.output_name }}" placeholder="merged.pdf" />
    </label>
    <label>
      {{ t.engine_label }}
      <select id="engine">
        <option value="pypdf" {% if defaults.engine == "pypdf" %}selected{% endif %}>{{ t.engine_pypdf }}</option>
        <option value="pikepdf" {% if defaults.engine == "pikepdf" %}selected{% endif %}>{{ t.engine_pikepdf }}</option>
      </select>
    </label>
    <label style="display: none;" >
      {{ t.api_key_label }}
      <input id="apiKey" type="text" placeholder="{{ t.api_key_placeholder }}" {% if not feature_flags.api_key_required %}disabled{% endif %}/>
    </label>
  </div>

  <div class="actions">
    <button id="mergeBtn" class="primary">
      <span style="padding-right: 0.5rem;">{{ t.merge_button }}</span>
    </button>
    <button id="reverseBtn" type="button" class="ghost" disabled>
      <svg class="button-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M8 5 5 8l3 3" />
        <path d="M5 8h10a4 4 0 0 1 4 4v7" />
        <path d="M16 19l3-3-3-3" />
        <path d="M19 16H9a4 4 0 0 1-4-4V5" />
      </svg>
      <span>{{ t.reverse_button }}</span>
    </button>
    <button id="clearBtn" type="button" class="ghost" disabled>
      <svg class="button-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M5 7h14" />
        <path d="M10 11v6" />
        <path d="M14 11v6" />
        <path d="M6 7l1 12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2l1-12" />
        <path d="M9 7V5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
      </svg>
      <span>{{ t.clear_button }}</span>
    </button>
    <span class="hint">{{ t.range_hint_html | safe }}</span>
  </div>
  <p id="status" class="status" role="status" aria-live="polite"></p>
</section>
{% endblock %}
